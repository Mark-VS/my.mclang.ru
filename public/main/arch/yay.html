<!DOCTYPE html>
<html lang="RU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yay</title>
    <link rel="stylesheet" href="/assets/styles/style.css">
    <link rel="stylesheet" href="/assets/highlight/styles_custom/androidstudio.css">
</head>
<body>
<script src="/assets/highlight/highlight.min.js"></script>

<a href="/arch">Вернуться назад</a>

<h1>yay</h1>

<h3>Установка</h3>
<pre><code class="language-bash">
# Ставим инструменты сборки:
sudo pacman -S --needed base-devel git
# (base-devel нужен для makepkg, git — чтобы скачать исходники).

# Клонируем репозиторий yay:
git clone https://aur.archlinux.org/yay.git
cd yay

# Собираем и устанавливаем:
makepkg -si
</code></pre>

<pre><code>
# Очистить кэш yay (только кэш, но НЕ исходники):
yay -Sc

# Очистить кэш yay вместе с исходниками:
yay -Scc
# Но всё-равно в ~/.cache/yay остаются клоны репозиториев и некоторые файлы
</code></pre>

<pre><code class="language-bash">yay -Rns $(yay -Qdtq)  # Удаляет ненужные зависимости, если они остались
</code></pre>

<h3>Удалить все локальные файлы сборки</h3>
<pre><code class="language-bash">
rm -rf ~/.cache/yay/freenet
</code></pre>

<pre><code class="language-bash">## Пропустить стадию проверки
yay -S portfolio-file-manager --mflags "--nocheck"
# Когда я ставил portfolio-file-manager, то пакет ставился нормально, но не проходил проверку и из-за этого установка отменялась.
## В таких случаях помогает установка без проверки
	</code></pre>
</code></pre>

<p>Перед установкой <strong><i>yay</i></strong> задаёт два вопроса. Первый:</p>
<pre><code class="language-bash">==> Пакеты, для которых требуется очистить кэш сборки?
==> [N]Нет [A]Все [Ab]Прервать [I]Установленные [No]Неустановленные или (1 2 3, 1-3, ^4)
</code></pre>
<p>Смысл вопроса: для каких <strong>AUR</strong>-пакетов удалить старые файлы сборки (PKGBUILD, src/, pkg/)? Когда <strong><i>yay</i></strong> собирает <strong>AUR</strong>-пакет, он скачивает PKGBUILD, кладёт всё в кэш (обычно ~/.cache/yay) и собирает пакет локально. Со временем там копятся старые версии, которые занимают место и иногда вызывают конфликты при пересборке. Варианты ответа:</p>
<ul>
   <li>Enter / N (Нет) – Ничего не чистит</li>
   <li>A (Все) – Удаляет кэш сборки для всех пакетов. Т.е. <strong>yay</strong> сначала удаляет весь кэш, а потом заново скачивает весь <strong>PKGBUILD</strong> и собирает текущий пакет.</li>
   <li>Ab (Прервать) – Прервать всё</li>
   <li>I (Установленные) – Чистит только те, что установлены сейчас. Т.е. все <strong>AUR</strong>-пакеты, которые сейчас установлены в системе, будут удалены из кэша, и только потом скачается <strong>PKGBUILD</strong> и собирётся текущий пакет.</li>
   <li>No (Неустановленные) – Чистит кэш удалённых пакетов. Т.е. из кэша удаляются удалённые из системы пакеты, а потом скачивается <strong>PKGBUILD</strong> и собирается.</li>
   <li>1 2 3 / 1-3 – Чистит выборочно. Тут нужно смотреть список пакетов. Перед вопросом про очистку кэша yay выводит список пакетов и можно выбрать из него явно те пакеты, для которых необходимо почистить кэш. Например: "1,2 6" означает "удалить 1,2 и 6-й пакеты. А "1-10 ^4" означает "Удалить с 1-го по 10-й, кроме 4-го".</li>
</ul>
<p>Очистка кэша происходит <strong>ДО сборки</strong>.</p>

<p>Второй вопрос:</p>
<pre><code class="language-bash">==> Показать изменения?
==> [N]Нет [A]Все [Ab]Прервать [I]Установленные [No]Неустановленные или (1 2 3, 1-3, ^4)
</code></pre>
<p>То есть: показать <strong>diff</strong> изменений в <strong>PKGBUILD</strong> и <strong>install</strong>-файлах перед сборкой? То есть будут показываться: изменения в <strong>PKGBUILD</strong>, изменения в <strong><i>.install</i></strong>, что добавилось / удалилось и команды, которые будут выполняться. Варианты ответа:</p>
<ul>
   <li>Enter / N (Нет) – Ничего не показывать</li>
   <li>A (Все) – Показать diff для всех пакетов</li>
   <li>Ab (Прервать) – Прервать</li>
   <li>I (Установленные) – Только уже установленные</li>
   <li>No (Неустановленные) – Только новые</li>
   <li>1 2 3 / 1-3 – Выборочно</li>
</ul>

<script src="/assets/highlight/languages/bash.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>