<!DOCTYPE html>
<html lang="RU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qt6</title>
    <style>
        body {
            font-size: 16px;
            background-color: #282C34;
            color: #8AA3AD;
        }
        a { color: #8AA3AD; }
    </style>
</head>
<body>
<a href="/arch">Вернуться назад</a>

<h1>Qt</h1>

<ul>
<li>
<h3>Переменные</h3>
<pre>
    QT_QPA_PLATFORM=wayland
    QT_QPA_PLATFORMTHEME=qt6ct
    QT_QPA_PALETTE="WindowText:#FF0000;Text:FF0000;ButtonText:#FF0000"
    QT_STYLE_OVERRIDE=kvantum
    QT_STYLE_SHEET=/home/mark/redtext.qss
</pre>
</li>

<li><h3>Qt6ct</h3>
<pre><code>
    ## Для начала ставим Qt6ct, чтобы настраивать стили:
        sudo pacman -S qt6ct
        
        ## Для работы qt6-приложений необходимо установить qt6-wayland
        ## А для работы qt6-приложений - qt5-waylan
        
    ## Конфигурационный файл: ~/.config/qt6ct/qt6ct.conf
        ## Цветовые схемы: ~/.config/qt6ct/colors/
        ## Стили: ~/.config/qt6ct/qss/
    ## Системный конфиг: /usr/share/qt6ct/qt6ct.conf
        ## Цветовые схемы: /usr/share/qt6ct/colors/
        ## Стили: /usr/share/qt6ct/qss/
    
    ## В программе можно выбрать три темы (стиля):
        Oxygen, Breeze, Windows, Fusion
    
    ## Как поменять тему.
        открываем программу qt6ct, настраиваем стили, цветовую схему, шрифты и нажимаем "Применить"
        теперь при запуске Qt6-приложения нам надо ему указать, откуда брать стиль - из программы qt6ct
        Это делается через переменную окружения QT_QPA_PLATFORMTHEME
        
        QT_QPA_PLATFORMTHEME=qt6c6 qbittorrent
        
    ## В моём дефолтном ~/.config/qt6ct/qt6ct.conf-файле ссылка на цветовую схему:
        color_scheme_path=/usr/share/qt6ct/colors/darker.conf
    ## Когда я меняю тему в qt6ct, то в файле ~/.config/qt6ct/qt6ct.conf меняется содержимаое.
        ## Если быть точным меняется только одна строка:
            style=Fusion на style=Oxygen, или на style=Windows
            ## Остальное остаётся как было.
    ## Если я хочу поменять цвета темы, нужно менять цвета в одной из цветовых схем в /usr/share/qt6ct/colors/.
    ## А ещё лучше скопировать цветовую схему из /usr/share/qt6ct/colors/ в ~/.config/qt6ct/colors/ и переименовать её во что-то своё.
        ## Например, назовём её "pipka". И тогда в программе Qt6ct в списке цветовых схем появится "pipka".
        ## Мы выберем пипку, а в файле ~/.config/qt6ct/qt6ct.conf укажем ссылку на пипку:
            color_scheme_path=/home/mark/.config/qt6ct/colors/pipka.conf
            
    ## Теперь запустим qbittorrent:
        QT_QPA_PLATFORMTHEME=qt6c6 qbittorrent
            ## Цветовая схема применилась
            
    ## В цветовой схеме qt6ct цвета указаны в одну строчку через запятую (21 штука), вот так:
    active_colors=#ffffffff, #ff424245, #ff979797, #ff5e5c5b, #ff302f2e, #ff4a4947, #ffffffff, #ffffffff, #ffffffff, #ff3d3d3d, #ff222020, #ffe7e4e0, #ff12608a, #fff9f9f9, #ff0986d3, #ffa70b06, #ff5c5b5a, #ffffffff, #ff3f3f36, #ffffffff, #80ffffff
            
    В Qt порядок цветов фиксирован. В qt6ct он такой (соответствует QPalette.ColorRole):
        1. Window (фон окна)
        2. WindowText (текст окна, основной текст) 
        3. Base (фон текстовых полей)      
        4. AlternateBase        
        5. ToolTipBase        
        6. ToolTipText       
        7. Text (текст в полях ввода / списках)        
        8. Button (фон кнопок)        
        9. ButtonText (текст кнопок)       
        10. BrightText (яркий текст, обычно для ошибок)       
        11. Highlight (фон выделения)       
        12. HighlightedText (текст на выделении)       
        13. Link       
        14. LinkVisited        
        15. PlaceholderText       
        16. Light       
        17. Midlight        
        18. Dark       
        19. Mid      
        20. Shadow       
        21. N/A (иногда используется для дополнительных целей)
        
    ## Но у Qt6ct есть один недостаток: его стили не применяются к KDE-приложениям.
    ## KDE-приложения: okular, kwrite, dolphin, elisa
    ## Qt6-приложения: featherpad, strawberry, qbittorrent, dragon, ark, kcalc, gwenview, qmmp, kfind
    
    ## Если мы запустим, например, Okular, то обнаружим, что цветовая схема не применилась:
        QT_QPA_PLATFORMTHEME=qt6c6 okular
    ## А если запустим любое Qt6-приложение, то цветовая схема применится:
        QT_QPA_PLATFORMTHEME=qt6c6 strawberry
</code></pre>
</li>

<li><h3>Kvantum</h3>
<pre><code>
    ## Если нам нужно устанавливать новые схемы и более гибко управлять темами, то нам понадобится Kvantum.
        sudo pacman -S kvantum
    ## Установились: Kvantum Manager и Kvantum Preview
    ## Через KvantumManager мы можем менять темы.
    
        sudo pacman -S kvantum-theme-materia    ## Ставим одну тему из оф. репозитория Arch
        yay -S kvantum-theme-arc                ## И ещё одну из AUR
        
        
    ## Темы устанавливаются в /usr/share/Kvantum/
        ## У нас вместе с kvantum-theme-materia установились три темы:
            /usr/share/Kvantum/Materia
            /usr/share/Kvantum/MateriaDark
            /usr/share/Kvantum/MateriaLight
        ## И вместе с kvantum-theme-arc тоже три:
            /usr/share/Kvantum/Arc
            /usr/share/Kvantum/ArcDark
            /usr/share/Kvantum/ArcDarker
        ## Остальные темы в /usr/share/Kvantum - дефолтные, которые поставились вместе с Kvantum'ом.
            
    ## Мы эти темы можем изменить в KvantumManager в разделе "Изменение или удаление тем".
        ## В этом разделе мы вибираем темы, которые есть в /usr/share/Kvantum/
        
    ## Мы также можем скопировать темы из /usr/share/Kvantum/ в ~/.config/Kvantum/
        ## Для этого зайдём в раздел "Утсановка/Обновление тем", выберем папку из /usr/share/Kvantum/ и нажмём "Установить".
        ## После этого тема скопируется из /usr/share/Kvantum/ в ~/.config/Kvantum/
        ## Теперь мы можем её кастомизировать под себя.
        
    ## Допустим, мы выбрали тему ArcDark и установили её в польовательскую директорию.
    ## Тогда мы можем редактировать эту тему в файле:
        ~/.config/Kvantum/ArcDark/ArcDark.kvconfig
        
    ## Запустим qbittorrent:
        QT_QPA_PLATFORMTHEME=qt6ct qbittorrent
    ## Тема применилась
    
    ## Qt6-приложения, которые можно потестить:
        featherpad, strawberry, qbittorrent, dragon, ark, kcalc, gwenview, qmmp, kfind, falkon
    ## KDE-приложения:
        dolphin, kwrite, okular, elisa
    
    
    ## А теперь давайте запустим  pdf-вьюер Okular:
        QT_QPA_PLATFORMTHEME=qt6ct okular
    ## Тема НЕ ПРИМЕНИЛАСЬ к этому приложению.
    ## Если вы посмотрите повнимательней, то обнаружите, что шрифты и размеры шрифтов, которые мы установили в qt6ct применились, 
        ... а вот всё, что мы настраивали в Kvantum, не применилось.
        
        
    ## А теперь давайте запустим Okular вот так:
        QT_QPA_PLATFORMTHEME=qt6ct QT_STYLE_OVERRIDE=kvantum okular
            ## Стили из kvantum применились
            ## от QT_QPA_PLATFORMЕTHEME сохранились настройки шрифта (размер)
            ## QT_STYLE_OVERRIDE - наложил дополнительно цветовую схему, оставив шрифты, настроенные в qt6ct
    
    ## Чтобы поменять отдельные цвета в Kvantum-теме, надо редактировать файл ~/.config/Kvantum/ArcDark/ArcDark.kvconfig
        ## Самые основные цвета хранятся в разделе: [GeneralColors]
        ## Дефолтный цвет шрифта:
            text.color=black
            
            [GeneralColors]
            window.color=#353945 - цвет фона, иногда кусок фона или даже текст иногда
            base.color=#404552 - фон окна в dolphin
            alt.base.color=#404552 - в Strawberry - фон некоторых трэков
            button.color=#444a58 - фиг знает, непонятно
            light.color=#404552 - тоже непонятно
            mid.light.color=#404552 - тоже фиг знает
            dark.color=#2F343f - в qbittorrent бордеры статусбаров
            mid.color=#2F343f - хз
            highlight.color=#5294E2 - подсвечивается фон текста на выбранном треке в плейлисте в Strawberry
            inactive.highlight.color=#5294E2 - фиг знает
            text.color=#d3dae3 - обычный текст. В dolphin - только столбик со списком файлов слева
            window.text.color=#d3dae3 - тоже текст в окне. В Dolphin - заголовки категорий в списке файлов слева
            button.text.color=#d3dae3 - фиг знает
            disabled.text.color=#898d99 - в Strawberry этим цветом отображается время на временной шкале
            tooltip.text.color=#d3dae3 - фиг знает
            highlight.text.color=#d3dae3 - цвет текста на выбранном треке в плейлисте в Strawberry
            link.color=#1d99f3 - фиг знает
            link.visited.color=#9b59b6 - фиг знает
            
            [ItemView]
            text.toggle.color=#ffffff - фиг знает
            
            [PanelButtonCommand]
            text.normal.color=#d3dae3 - пункты меню (айтемы)
            text.focus.color=#d3dae3 - цвет пунктов меню, когда на них наводиш мышку и кликаешь
            text.press.color=#ffffff - цвет текста на кнопках во время нажатия, например в Dragon
            text.toggle.color=#ffffff - фиг знает
            
            [Tab]
            text.normal.color=#898d99 - цвет текста в плейлистах Strawberry, например
            text.focus.color=#ffffff - цвет текста в плейлистах Strawberry, когда наводишь на него курсор
            text.press.color=#ffffff - хз
            text.toggle.color=#ffffff - цвет текста в текущем, активном плейлисте в Strawberry
            
            [HeaderSection]
            text.normal.color=#d3dae3 - заголовки (в плейлистах Strawberry, в списке торрентов в Qbittorrent)
            text.focus.color=#5294e2 - цвет текста заголовков, когда на них наводишь мышку
            text.press.color=#d3dae3 - цвет текста заголовков, когда я их хватаю курсором и тащу
            text.toggle.color=#d3dae3 - фиг знает
            
            [Toolbar]
            text.normal.color=#d3dae3 - текст меню (в Strawberry - нет)(в Dolphin - одна надпись на верхней панели) (В Dolphin почему-то становятся белыми пара кнопок на верхней панели... какой бы цвет я не поставил сюда, кнопки становятся белыми)
            text.focus.color=#d3dae3 - фиг знает
            text.press.color=#ffffff - фиг знает
            text.toggle.color=#ffffff - фиг знает
            
            [ToolbarButton]
            text.normal.color=#d3dae3 - фиг знает
            ...
            
            [Progressbar]
            text.normal.color=#d3dae3 - фиг знает где
            ...
            
            [Menu]
            text.press.color=#ffffff - фиг знает
            text.toggle.color=#ffffff - фиг знает
            
            [MenuItem]
            text.focus.color=#ffffff - пункт меню, когда на него наводишь курсор
            text.press.color=#ffffff - пункт меню, когда на него нижмаем
            
            [ComboBox]
            text.toggle.color=#ffffff - фиг знает
            
            [ToolboxTab]
            text.normal.color=#d3dae3 - фиг знает
            text.press.color=#ffffff - фиг знает
            text.focus.color=#d3dae3 - фиг знает
        
            
        
        QT_QPA_PLATFORMTHEME=qt6ct QT_STYLE_OVERRIDE=kvantum dolphin
            ## А вот тут не все цвета применяются
            ## Например, цвет текста, которым подписываются файлы, не меняется.
            ## BreadCrumbs тоже не меняются
            
        ## 
        ## С цветом текста слева (список файлов и папок) ещё можно что-то предпринять, покопавшись в ~/.config/Kvantum/ArcDark/ArcDark.kvconfig,
        ## С BreadCrumbs можно попробовать что-то намудрить, используя .qss-стили, ...
        ## ... а вот с текстом под файлами ничего сделать не получается. Откуда он берётся - фиг знает.
        ## Выход: не пользоваться Dolphin'ом.
            
            
    ## Программы из пакета qt6-tools: assistant, designer, linguist
        Эти программы вообще не поддаются никакому изменению. Тут оформление вшито в бинарники и не меняется.
            
            
    ## ДОПОЛНИТЕЛЬНО
        
        Вроде как есть ещё ~/.config/kdeglobals, откуда KDE-приложения берут цветовые настройки.
        Для того, чтобы цветовые схемы применялись, надо чтобы в фоне был запущен демон kded6.
        
        ## То есть после того, как мы изменили kdeglobals, надо сделать примерно следующее:
            kbuildsycoca6       // применяем новые настройки из kdeglobals
            kquitapp6 kded6     // завершаем процесс kded6
            kded6               // заново запускаем kded6
                            
        ## Цветовые схемы можно писать напрямую в ~/.config/kdeglobals, а можно подгружать из специальных папок:
            ## локальная папка: ~/.local/share/color-schemes/
            ## системная папка: /usr/share/color-schemes/
            
    
    ## Но у мне этот способ не заработал.
        
</code></pre></li>


</ul>

</body>
</html>