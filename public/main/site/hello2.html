<!DOCTYPE html>
<html lang="RU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="/assets/styles/style.css">
    <link rel="stylesheet" href="/assets/highlight/styles_custom/androidstudio.css">
</head>
<body>
<script src="/assets/highlight/highlight.min.js"></script>
<p><a href="/site">Вернуться назад</a></p>

<p>Устанавливаем Vue+TS:</p>
<pre><code class="language-bash"># Ставим Vue + TypeScript:

pnpm create vite@latest frontend -- --template vue-ts
# Это просто удобная обёртка над:
pnpm dlx create-vite@latest frontend --template vue-ts

# Или:
pnpm add create-vite --save-dev
pnpm exec create-vite frontend --template vue-ts
pnpm remove create-vite
</code></pre>

<p>Как запустить сервер Vue в режиме разработки из папки <strong><i>frontend</i></strong>:</p>
<pre><code class="language-bash"># с помощью pnpm:
pnpm --dir frontend run dev

# с помощью npm:
npm run dev --prefix frontend
</code></pre>

<p>Создаём компонент Govno.vue:</p>
<pre><code class="language-xml">// frontend/src/components/Govno.vue

&lt;script setup&gt;
    import { ref } from 'vue';
    const count = ref(0);
&lt;/script&gt;

&lt;template&gt;
    &lt;h1&gt;Говно&lt;/h1&gt;

    &lt;p&gt;Счётчик: {{ count }}&lt;/p&gt;
    &lt;button v-on:click="count++"&gt;Кнопка&lt;/button&gt;
&lt;/template&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</code></pre>

<p>Подключаем компонент Govno в App.vue:</p>
<pre><code class="language-xml">// frontend/src/App.vue

&lt;script setup lang="ts"&gt;
   import Govno from './components/Govno.vue'
&lt;/script&gt;

&lt;template&gt;
  &lt;Govno /&gt;
&lt;/template&gt;
</code></pre>

<p>Подключаем главные компонент App.vue в main.ts:</p>
<pre><code class="language-typescript">// frontend/src/main.ts

import { createApp } from 'vue'
import './style.css'
import App from './App.vue'

createApp(App).mount('#app')
</code></pre>

<p>После подключения компонента Govno.vue в App.vue, <strong><i>VSCodium</i></strong> начнёт ругаться:</p>
<pre><code class="language-bash">Could not find a declaration file for module './components/Govno.vue'.
'/home/mark/projects/vue/pupa/frontend/src/components/Govno.vue' implicitly has an 'any' type.</code></pre>

<p>Нужно просто объявить типизацию для .vue-файлов.</p>
<p>Для этого создадим <strong><i>env.d.ts</i></strong>:</p>
<pre><code class="language-typescript">// frontend/src/env.d.ts

/// &lt;reference types="vite/client" /&gt;

declare module '*.vue' {
  import type { DefineComponent } from 'vue'
  const component: DefineComponent<{}, {}, any>
  export default component
}
</code></pre>

<p>Приблизительное содержание tsconfig.app.json:</p>
<pre><code class="language-json">// frontend/tsconfig.app.json

{
  "compilerOptions": {
    "types": ["vite/client"]
  },
  "include": ["src/**/*.ts", "src/**/*.d.ts", "src/**/*.vue"]
}
</code></pre>
<p>Тут надо, чтобы в раделе "include" был включён наш созданный ранее <strong><i>env.d.ts</i></strong>.</p>
<p>Вот мой дефолтный tsconfig.app.json, созданный Vite (тут уже включён наш файл <strong><i>env.d.ts</i></strong>):</p>
<pre><code class="language-json">// frontend/tsconfig.app.json

{
  "extends": "@vue/tsconfig/tsconfig.dom.json",
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "types": ["vite/client"],

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src/**/*.ts", "src/**/*.tsx", "src/**/*.vue"]
}
</code></pre>

<h2>Backend</h2>

<p>Ставим типы для Node</p>
<pre><code class="language-bash"># Ставим типы для Node:
pnpm add @types/node --save-dev
</code></pre>

<p>Чуть выше я установил типы для <strong><i>Node.js</i></strong>. Теперь в <strong><i>node_modules/@types/node</i></strong> лежат файлы с описанием всех встроенных модулей <strong><i>Node.js</i></strong> (fs, path, process, Buffer и т. д.).</p>
<p>Теперь в <strong><i>tsconfig.json</i></strong> мы говорим: «Подключай только типы, относящиеся к Node.js.»:</p>
<pre><code class="language-json">// tsconfig.json
  
"types": ["node"],
</code></pre>

<p><strong><i>Если не указать тип</i></strong> (то есть просто удалишь строку внутри массива: "types": []), TypeScript сам попробует подключить все типы из node_modules/@types/. Это тоже будет работать, но иногда может подключить лишние типы (например, @types/dom от какой-то другой зависимости). Поэтому в серверных проектах на Node.js принято явно указывать: "node".</p>

<pre><code class="language-bash"># Ставим <strong><i>Express</i></strong> и типы для него:
pnpm add express --save-prod
pnpm add @types/express --save-dev
</code></pre>

<p>Подключение ts-файлов:</p>
<pre><code class="language-json">// tsconfig.json

{
   "files": ["./backend/src/server.js"],
   "compilerOptions": {
      "rootDir": "./backend/src",
      "outDir": "./backend/dist"
      ...
   }
}
</code></pre>

<script src="/assets/highlight/languages/xml.min.js"></script>
<script src="/assets/highlight/languages/bash.min.js"></script>
<script src="/assets/highlight/languages/json.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>